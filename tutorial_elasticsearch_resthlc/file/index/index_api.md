# index api 
https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html

## 版本控制



## 版本类型


## 操作类型


## 自动生成ID


## 路由


## 分布式
索引操作根据其路由(参见上面的路由部分)指向主分片,并在包含此分片的实际节点上执行. 在主分片完成操作后,如果需要,更新将分发到相应的副本


## 等待活动分片
为了提高写入系统的灵活性,索引操作可以配置为在继续操作之前等待一定数量的活动分片副本.如果所需数量的活动分片副本不可用,则写入操作必须等待并重试直到必要的分片副本已启动或发生超时.
默认情况下,写入操作仅等待主分片在进行之前处于活动状态(即wait_for_active_shards = 1).  
通过设置index.write.wait_for_active_shards可以动态覆盖此默认值
```
例如，假设我们有一个由三个节点A，B和C组成的集群，并且我们创建了一个索引index，其副本数设置为3（导致4个分片副本，比节点多一个副本）。如果我们尝试进行索引操作：
1、默认情况下，操作只会确保每个分片的主分片可用，然后才能继续。这意味着，即使B和C发生故障，并且A托管了主分片副本，索引操作仍然会继续执行这唯一的一个数据副本。
2、如果请求中的wait_for_active_shards设置为3（并且所有3个节点都在运行），那么索引操作在继续之前需要3个活动分片副本，满足要求，因为集群中有3个活动节点，每个节点持有分片的副本。
3、如果我们将wait_for_active_shards设置为all（或者4也一样），则索引操作将不会继续，因为我们没有在索引中激活每个分片的所有4个副本。该操作将超时，除非在集群中引入新节点来托管分片的第四个副本
```


## Noop Updates


## Timeout
默认情况下,索引操作将在主分片上等待最多1分钟,然后如果失败则响应并显示错误.